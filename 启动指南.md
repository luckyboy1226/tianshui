# 🚀 天水平台启动指南

## 问题解决

### 错误：找不到 manage.py 文件

**问题原因：** 项目结构不完整，缺少 `manage.py` 文件

**解决方案：** 我已经为您创建了 `manage.py` 文件

## 快速启动步骤

### 第一步：检查项目结构
```bash
# 运行项目检查脚本
python check_project.py
```

这个脚本会检查：
- ✅ 所有必需文件是否存在
- ✅ Django环境是否正常
- ✅ 项目结构是否完整

### 第二步：安装依赖
```bash
# 安装Python依赖包
pip install -r requirements_dev.txt
```

### 第三步：设置数据库
```bash
# 创建数据库迁移
python manage.py makemigrations --settings=tianshuipy.settings_dev

# 执行数据库迁移
python manage.py migrate --settings=tianshuipy.settings_dev
```

### 第四步：创建超级用户
```bash
# 创建管理员账号
python manage.py shell --settings=tianshuipy.settings_dev
```

在Django shell中运行：
```python
from users.models import User
User.objects.create_superuser('admin', 'admin@example.com', 'admin123')
exit()
```

### 第五步：启动服务器
```bash
# 启动开发服务器
python manage.py runserver --settings=tianshuipy.settings_dev
```

### 第六步：访问系统
- 🌐 管理后台：http://127.0.0.1:8000/admin/
- 📚 API文档：http://127.0.0.1:8000/api/docs/
- 🔑 默认账号：admin / admin123

## 一键启动（推荐）

如果上述步骤太复杂，可以直接运行：

```bash
# 一键启动脚本
python start_dev.py
```

这个脚本会自动完成所有配置步骤。

## 常见问题

### 问题1：ImportError: No module named 'django'
```bash
# 解决方案：安装Django
pip install django==5.2.4
```

### 问题2：ModuleNotFoundError: No module named 'rest_framework'
```bash
# 解决方案：安装Django REST Framework
pip install djangorestframework==3.14.0
```

### 问题3：数据库迁移失败
```bash
# 解决方案：删除数据库文件重新开始
rm db.sqlite3
python manage.py makemigrations --settings=tianshuipy.settings_dev
python manage.py migrate --settings=tianshuipy.settings_dev
```

### 问题4：端口被占用
```bash
# 解决方案：使用其他端口
python manage.py runserver 8001 --settings=tianshuipy.settings_dev
```

## 项目结构说明

```
tianshuipy/                    # 项目根目录
├── manage.py                  # Django管理脚本
├── tianshuipy/               # Django项目配置
│   ├── __init__.py
│   ├── settings.py           # 生产环境配置
│   ├── settings_dev.py       # 开发环境配置
│   ├── urls.py               # 主URL配置
│   ├── wsgi.py
│   └── asgi.py
├── users/                    # 用户管理应用
│   ├── __init__.py
│   ├── models.py
│   ├── views.py
│   ├── serializers.py
│   └── urls.py
├── environment/              # 环境监测应用
│   ├── __init__.py
│   ├── models.py
│   ├── views.py
│   ├── serializers.py
│   ├── tasks.py
│   ├── ecological_indices.py
│   └── urls.py
├── requirements_dev.txt      # 开发环境依赖
├── start_dev.py             # 一键启动脚本
├── check_project.py         # 项目检查脚本
└── 启动指南.md              # 本文件
```

## API接口测试

### 1. 测试用户登录
```bash
curl -X POST http://127.0.0.1:8000/api/v1/users/users/login/ \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "admin123"}'
```

### 2. 测试API文档
访问：http://127.0.0.1:8000/api/docs/

## 下一步

1. **前端开发** - 参考 `frontend_config.md`
2. **功能扩展** - 添加更多生态指数算法
3. **性能优化** - 添加缓存和异步处理
4. **部署上线** - 配置生产环境

---

**提示：** 开发环境使用SQLite数据库，适合学习和开发。生产环境建议使用PostgreSQL。 